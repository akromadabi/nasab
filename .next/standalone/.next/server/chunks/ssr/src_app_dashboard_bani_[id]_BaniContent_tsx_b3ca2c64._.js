module.exports=[31052,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(61690),e=a.i(69602),f=a.i(34044),g=a.i(70106);let h=(0,g.default)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]);var i=a.i(63519),j=a.i(46842),k=a.i(5784),l=a.i(67552),m=a.i(52495),n=a.i(87532),o=a.i(15618),p=a.i(70255),q=a.i(76472),r=a.i(60246),s=a.i(96221),t=a.i(33508),u=a.i(50522),v=a.i(13749),w=a.i(74708),x=a.i(67329);let y=(0,g.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),z=(0,g.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),A=(0,g.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var B=a.i(81560),C=a.i(21161);let D=(0,g.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var E=a.i(43108);let F=(0,g.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),G=(0,g.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),H=(0,g.default)("arrow-down-up",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);var I=a.i(1631);let J=(0,g.default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var K=a.i(68114),L=a.i(2549);let M=[{key:"instagram",label:"Instagram",placeholder:"@username",color:"text-pink-600",bg:"bg-pink-50"},{key:"facebook",label:"Facebook",placeholder:"Nama atau URL",color:"text-blue-600",bg:"bg-blue-50"},{key:"tiktok",label:"TikTok",placeholder:"@username",color:"text-surface-900",bg:"bg-surface-100"},{key:"twitter",label:"Twitter / X",placeholder:"@username",color:"text-sky-500",bg:"bg-sky-50"},{key:"youtube",label:"YouTube",placeholder:"Channel URL",color:"text-red-600",bg:"bg-red-50"},{key:"linkedin",label:"LinkedIn",placeholder:"URL profil",color:"text-blue-700",bg:"bg-blue-50"}];function N(a,b){let c=b.trim();if(c.startsWith("http://")||c.startsWith("https://"))return c;let d=c.replace(/^@/,"");switch(a){case"instagram":return`https://instagram.com/${d}`;case"facebook":return`https://facebook.com/${d}`;case"tiktok":return`https://tiktok.com/@${d}`;case"twitter":return`https://x.com/${d}`;case"youtube":return`https://youtube.com/${d.startsWith("@")?d:"@"+d}`;case"linkedin":return`https://linkedin.com/in/${d}`;default:return"#"}}function O({platform:a,className:c="w-4 h-4"}){switch(a){case"instagram":return(0,b.jsx)("svg",{className:c,viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"})});case"facebook":return(0,b.jsx)("svg",{className:c,viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})});case"tiktok":return(0,b.jsx)("svg",{className:c,viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("path",{d:"M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"})});case"twitter":return(0,b.jsx)("svg",{className:c,viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})});case"youtube":return(0,b.jsx)("svg",{className:c,viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})});case"linkedin":return(0,b.jsx)("svg",{className:c,viewBox:"0 0 24 24",fill:"currentColor",children:(0,b.jsx)("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})});default:return(0,b.jsx)(m.ExternalLink,{className:c})}}function P({entries:a,onChange:d,inputClass:e,labelClass:f}){let[g,h]=(0,c.useState)(!1),i=a.map(a=>a.key),j=M.filter(a=>!i.includes(a.key));return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:f,children:"Sosial Media"}),a.map((c,f)=>{let g=M.find(a=>a.key===c.key);return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`w-8 h-8 rounded-lg ${g?.bg||"bg-surface-100"} ${g?.color||"text-surface-500"} flex items-center justify-center flex-shrink-0`,children:(0,b.jsx)(O,{platform:c.key,className:"w-4 h-4"})}),(0,b.jsx)("input",{type:"text",value:c.value,onChange:b=>{var c;let e;return c=b.target.value,void((e=[...a])[f]={...e[f],value:c},d(e))},className:`${e} flex-1`,placeholder:g?.placeholder||""}),(0,b.jsx)("button",{type:"button",onClick:()=>{d(a.filter((a,b)=>b!==f))},className:"w-8 h-8 rounded-lg border border-surface-200 text-surface-400 flex items-center justify-center hover:bg-red-50 hover:text-red-500 hover:border-red-200 transition-colors flex-shrink-0",children:(0,b.jsx)(t.X,{className:"w-3.5 h-3.5"})})]},c.key)}),j.length>0&&(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>h(!g),className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-dashed border-surface-300 text-xs text-surface-500 font-medium hover:border-primary-400 hover:text-primary-600 transition-colors",children:[(0,b.jsx)(o.Plus,{className:"w-3.5 h-3.5"}),"Tambah Sosial Media"]}),g&&(0,b.jsx)("div",{className:"absolute left-0 top-full mt-1 w-56 bg-white rounded-xl border border-surface-200 shadow-xl z-20 p-1 animate-scale-in",children:j.map(c=>(0,b.jsxs)("button",{type:"button",onClick:()=>{d([...a,{key:c.key,value:""}]),h(!1)},className:"w-full flex items-center gap-2.5 px-3 py-2 rounded-lg hover:bg-surface-50 transition-colors text-left",children:[(0,b.jsx)("div",{className:`w-7 h-7 rounded-md ${c.bg} ${c.color} flex items-center justify-center`,children:(0,b.jsx)(O,{platform:c.key,className:"w-3.5 h-3.5"})}),(0,b.jsx)("span",{className:"text-sm text-surface-700 font-medium",children:c.label})]},c.key))})]})]})}function Q({node:a,onSelect:c,onClose:d}){return(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",onClick:d,children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),(0,b.jsxs)("div",{className:"relative w-full max-w-xs bg-white rounded-2xl shadow-2xl animate-scale-in overflow-hidden",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"px-4 pt-4 pb-3 border-b border-surface-100",children:[(0,b.jsx)("p",{className:"text-xs text-surface-400 font-medium",children:"Tambah keluarga untuk"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-surface-900 truncate",children:a.fullName})]}),(0,b.jsxs)("div",{className:"p-2",children:[(0,b.jsxs)("button",{onClick:()=>c("child"),className:"w-full flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-primary-50 transition-colors",children:[(0,b.jsx)("div",{className:"w-9 h-9 rounded-lg bg-primary-100 flex items-center justify-center",children:(0,b.jsx)(p.Baby,{className:"w-4.5 h-4.5 text-primary-600"})}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-surface-800",children:"Tambah Anak"}),(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Anak kandung"})]})]}),(0,b.jsxs)("button",{onClick:()=>c("spouse"),className:"w-full flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-pink-50 transition-colors",children:[(0,b.jsx)("div",{className:"w-9 h-9 rounded-lg bg-pink-100 flex items-center justify-center",children:(0,b.jsx)(q.Heart,{className:"w-4.5 h-4.5 text-pink-600"})}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-surface-800",children:"Tambah Pasangan"}),(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Suami / Istri"})]})]}),(0,b.jsxs)("button",{onClick:()=>c("sibling"),className:"w-full flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-blue-50 transition-colors",children:[(0,b.jsx)("div",{className:"w-9 h-9 rounded-lg bg-blue-100 flex items-center justify-center",children:(0,b.jsx)(r.Users,{className:"w-4.5 h-4.5 text-blue-600"})}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-surface-800",children:"Tambah Saudara"}),(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Saudara kandung"})]})]})]}),(0,b.jsx)("div",{className:"px-2 pb-2",children:(0,b.jsx)("button",{onClick:d,className:"w-full py-2.5 rounded-xl text-sm font-medium text-surface-400 hover:bg-surface-50 transition-colors",children:"Batal"})})]})]})}function R({context:a,allMembers:d,baniId:e,onClose:f,onSuccess:g}){let[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)("MALE"),[n,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(!1),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),{type:y,member:z}=a,A=[];"MALE"===z.gender&&z.marriagesAsHusband?z.marriagesAsHusband.forEach(a=>A.push(a.wife)):"FEMALE"===z.gender&&z.marriagesAsWife&&z.marriagesAsWife.forEach(a=>A.push(a.husband));let B=1===A.length,C=A.length>1;(0,c.useEffect)(()=>{"child"===y&&B&&x(A[0].id)},[y,B]);let D="child"===y?`Tambah Anak ${z.fullName}`:"spouse"===y?`Tambah Pasangan ${z.fullName}`:`Tambah Saudara ${z.fullName}`,E="child"===y?"Anggota baru akan menjadi anak dari orang ini":"spouse"===y?"Anggota baru akan menjadi pasangan orang ini":"Anggota baru akan memiliki orang tua yang sama";(0,c.useEffect)(()=>{"spouse"===y&&m("MALE"===z.gender?"FEMALE":"MALE")},[y,z.gender]);let F="child"===y?A.length>0?A.map(a=>({id:a.id,fullName:a.fullName,gender:a.gender,generation:0})):"MALE"===z.gender?d.filter(a=>"FEMALE"===a.gender):d.filter(a=>"MALE"===a.gender):[],G=async a=>{if(a.preventDefault(),h.trim()){r(!0),v("");try{let a,b;"child"===y?"MALE"===z.gender?(a=z.id,b=w||void 0):(b=z.id,a=w||void 0):"sibling"===y&&(a=z.fatherId||void 0,b=z.motherId||void 0);let c=await fetch("/api/members",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({baniId:e,fullName:h.trim(),nickname:j.trim()||void 0,gender:l,isAlive:n,fatherId:a,motherId:b})}),d=await c.json();if(!c.ok)return void v(d.error||"Gagal menyimpan");if("spouse"===y){let a="MALE"===z.gender?z.id:d.id,b="FEMALE"===z.gender?z.id:d.id;(await fetch("/api/marriages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({husbandId:a,wifeId:b})})).ok||console.error("Failed to create marriage, but member was created")}g()}catch{v("Terjadi kesalahan. Silakan coba lagi.")}finally{r(!1)}}};return(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:f}),(0,b.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto animate-scale-in",children:[(0,b.jsxs)("div",{className:"sticky top-0 bg-white rounded-t-2xl border-b border-surface-100 p-5 flex items-start justify-between z-10",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-surface-900",children:D}),(0,b.jsx)("p",{className:"text-xs text-surface-400 mt-0.5",children:E})]}),(0,b.jsx)("button",{onClick:f,className:"p-1.5 rounded-lg hover:bg-surface-100 transition-colors text-surface-400",children:(0,b.jsx)(t.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("form",{onSubmit:G,className:"p-5 space-y-4",children:[u&&(0,b.jsx)("div",{className:"p-3 rounded-xl bg-red-50 border border-red-200 text-red-700 text-sm",children:u}),"child"===y&&(0,b.jsx)("div",{className:"p-3 rounded-xl bg-primary-50 border border-primary-100",children:(0,b.jsxs)("p",{className:"text-xs font-medium text-primary-700",children:["MALE"===z.gender?"ðŸ‘¨ Ayah":"ðŸ‘© Ibu",":"," ",(0,b.jsx)("span",{className:"font-bold",children:z.fullName})]})}),"sibling"===y&&(z.fatherId||z.motherId)&&(0,b.jsxs)("div",{className:"p-3 rounded-xl bg-blue-50 border border-blue-100 space-y-1",children:[(0,b.jsxs)("p",{className:"text-xs text-blue-600",children:["Orang tua yang sama dengan ",z.fullName,":"]}),z.fatherId&&(0,b.jsxs)("p",{className:"text-xs font-medium text-blue-700",children:["ðŸ‘¨ Ayah: ",d.find(a=>a.id===z.fatherId)?.fullName||"â€”"]}),z.motherId&&(0,b.jsxs)("p",{className:"text-xs font-medium text-blue-700",children:["ðŸ‘© Ibu: ",d.find(a=>a.id===z.motherId)?.fullName||"â€”"]})]}),"spouse"===y&&(0,b.jsx)("div",{className:"p-3 rounded-xl bg-pink-50 border border-pink-100",children:(0,b.jsxs)("p",{className:"text-xs font-medium text-pink-700",children:["ðŸ’‘ Pasangan dari ",(0,b.jsx)("span",{className:"font-bold",children:z.fullName})]})}),"child"===y&&B&&(0,b.jsx)("div",{className:"p-3 rounded-xl bg-primary-50 border border-primary-100",children:(0,b.jsxs)("p",{className:"text-xs font-medium text-primary-700",children:["MALE"===z.gender?"ðŸ‘© Ibu":"ðŸ‘¨ Ayah",":"," ",(0,b.jsx)("span",{className:"font-bold",children:A[0].fullName})]})}),"child"===y&&C&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-surface-700 mb-1.5",children:"MALE"===z.gender?"Ibu":"Ayah"}),(0,b.jsxs)("select",{value:w,onChange:a=>x(a.target.value),className:"w-full px-3 py-2.5 rounded-xl border border-surface-200 text-sm text-surface-900 focus:outline-none focus:border-primary-500 bg-white",children:[(0,b.jsxs)("option",{value:"",children:["â€” Pilih ","MALE"===z.gender?"Ibu":"Ayah"," â€”"]}),F.map(a=>(0,b.jsx)("option",{value:a.id,children:a.fullName},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-surface-700 mb-1.5",children:["Nama Lengkap ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:h,onChange:a=>i(a.target.value),className:"w-full px-3 py-2.5 rounded-xl border border-surface-200 text-sm text-surface-900 placeholder-surface-400 focus:outline-none focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 bg-white",placeholder:"Nama lengkap",autoFocus:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-surface-700 mb-1.5",children:"Nama Panggilan"}),(0,b.jsx)("input",{type:"text",value:j,onChange:a=>k(a.target.value),className:"w-full px-3 py-2.5 rounded-xl border border-surface-200 text-sm text-surface-900 placeholder-surface-400 focus:outline-none focus:border-primary-500 bg-white",placeholder:"Panggilan sehari-hari"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-surface-700 mb-1.5",children:["Jenis Kelamin ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>m("MALE"),className:`py-2.5 rounded-xl text-sm font-medium transition-all ${"MALE"===l?"bg-blue-50 text-blue-700 border-2 border-blue-300":"bg-white text-surface-500 border border-surface-200 hover:bg-surface-50"}`,children:"ðŸ‘¨ Laki-laki"}),(0,b.jsx)("button",{type:"button",onClick:()=>m("FEMALE"),className:`py-2.5 rounded-xl text-sm font-medium transition-all ${"FEMALE"===l?"bg-pink-50 text-pink-700 border-2 border-pink-300":"bg-white text-surface-500 border border-surface-200 hover:bg-surface-50"}`,children:"ðŸ‘© Perempuan"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-surface-700 mb-1.5",children:"Status"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>p(!0),className:`py-2.5 rounded-xl text-sm font-medium transition-all ${n?"bg-green-50 text-green-700 border-2 border-green-300":"bg-white text-surface-500 border border-surface-200 hover:bg-surface-50"}`,children:"â¤ï¸ Hidup"}),(0,b.jsx)("button",{type:"button",onClick:()=>p(!1),className:`py-2.5 rounded-xl text-sm font-medium transition-all ${!n?"bg-surface-100 text-surface-700 border-2 border-surface-300":"bg-white text-surface-500 border border-surface-200 hover:bg-surface-50"}`,children:"ðŸ•Šï¸ Wafat"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)("button",{type:"button",onClick:f,className:"flex-1 py-2.5 rounded-xl border border-surface-200 text-surface-600 font-medium text-sm hover:bg-surface-50 transition-colors",children:"Batal"}),(0,b.jsx)("button",{type:"submit",disabled:q||!h.trim(),className:"flex-1 py-2.5 rounded-xl bg-gradient-to-r from-primary-600 to-primary-700 text-white font-semibold text-sm hover:from-primary-500 hover:to-primary-600 transition-all shadow-lg shadow-primary-600/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Loader2,{className:"w-4 h-4 animate-spin"}),"Menyimpan..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Plus,{className:"w-4 h-4"}),"Simpan"]})})]})]})]})]})}function S({node:a,level:c,expanded:d,toggleExpand:e,selectedId:f,onSelect:g,onShowQuickMenu:h,canEdit:m=!0,orientation:n}){let p,q=d.has(a.id),r=a.children.length>0,s=f===a.id,t="HORIZONTAL"===n,w=(0,b.jsxs)("div",{onClick:()=>g(a.id),className:`tree-node relative cursor-pointer rounded-xl sm:rounded-2xl border-2 p-2 sm:p-3 w-28 sm:w-44 text-center transition-all group ${s?"border-primary-500 bg-primary-50 shadow-lg shadow-primary-500/20":a.isAlive?"MALE"===a.gender?"border-blue-200 bg-white hover:border-blue-400":"border-pink-200 bg-white hover:border-pink-400":"border-surface-200 bg-surface-50 opacity-80 hover:opacity-100"}`,children:[(0,b.jsx)("div",{className:`w-9 h-9 sm:w-12 sm:h-12 rounded-full mx-auto mb-1 sm:mb-2 flex items-center justify-center ${"MALE"===a.gender?"bg-blue-100 text-blue-600":"bg-pink-100 text-pink-600"}`,children:a.photo?(0,b.jsx)("img",{src:a.photo,alt:a.fullName,className:"w-9 h-9 sm:w-12 sm:h-12 rounded-full object-cover"}):(0,b.jsx)(j.User,{className:"w-4 h-4 sm:w-6 sm:h-6"})}),(0,b.jsx)("p",{className:"text-xs sm:text-sm font-semibold text-surface-900 truncate",children:a.fullName}),a.nickname&&(0,b.jsxs)("p",{className:"text-[10px] text-surface-400 truncate",children:["(",a.nickname,")"]}),!a.isAlive&&(0,b.jsx)("span",{className:"inline-block text-[10px] px-1.5 py-0.5 rounded bg-surface-200 text-surface-500 mt-1",children:"Alm."}),(p=[],("MALE"===a.gender&&a.marriagesAsHusband?a.marriagesAsHusband.forEach(a=>p.push(a.wife.fullName)):"FEMALE"===a.gender&&a.marriagesAsWife&&a.marriagesAsWife.forEach(a=>p.push(a.husband.fullName)),0===p.length)?null:(0,b.jsx)("div",{className:"mt-1.5 space-y-0.5",children:p.map((c,d)=>(0,b.jsxs)("p",{className:`text-[9px] sm:text-[10px] truncate px-1.5 py-0.5 rounded-full ${"MALE"===a.gender?"bg-pink-50 text-pink-500":"bg-blue-50 text-blue-500"}`,children:["ðŸ’‘ ",c]},d))})),s&&m&&a.phoneWhatsapp&&(0,b.jsx)("a",{href:(0,K.getWhatsAppLink)(a.phoneWhatsapp),target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),className:"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-green-500 text-white flex items-center justify-center shadow-md hover:bg-green-400 transition-all animate-scale-in z-10",children:(0,b.jsx)(i.Phone,{className:"w-3 h-3"})}),s&&m&&(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),h(a)},className:"absolute -top-2 -left-2 z-30 w-6 h-6 rounded-full bg-emerald-500 text-white flex items-center justify-center shadow-md hover:bg-emerald-400 transition-all hover:scale-110 animate-scale-in",title:"Tambah keluarga",children:(0,b.jsx)(o.Plus,{className:"w-3 h-3"})}),r&&(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),e(a.id)},className:t?"absolute top-1/2 -right-3 -translate-y-1/2 w-6 h-6 rounded-full bg-primary-500 text-white flex items-center justify-center shadow-md hover:bg-primary-400 transition-colors text-xs":"absolute -bottom-3 left-1/2 -translate-x-1/2 w-6 h-6 rounded-full bg-primary-500 text-white flex items-center justify-center shadow-md hover:bg-primary-400 transition-colors text-xs",children:t?q?(0,b.jsx)(v.ChevronLeft,{className:"w-3.5 h-3.5"}):(0,b.jsx)(u.ChevronRight,{className:"w-3.5 h-3.5"}):q?(0,b.jsx)(l.ChevronUp,{className:"w-3.5 h-3.5"}):(0,b.jsx)(k.ChevronDown,{className:"w-3.5 h-3.5"})})]});return t?(0,b.jsxs)("div",{className:"flex flex-row items-center",children:[w,r&&q&&(0,b.jsxs)("div",{className:"flex flex-row items-center",children:[(0,b.jsx)("div",{className:"h-0.5 w-8 bg-gradient-to-r from-primary-300 to-primary-200"}),(0,b.jsx)("div",{className:"flex flex-col",children:a.children.map((i,j)=>(0,b.jsxs)("div",{className:"flex flex-row items-center relative",children:[a.children.length>1&&(0,b.jsxs)("div",{className:"flex flex-col w-0.5 self-stretch",children:[(0,b.jsx)("div",{className:`flex-1 w-full ${0===j?"bg-transparent":"bg-primary-200"}`}),(0,b.jsx)("div",{className:`flex-1 w-full ${j===a.children.length-1?"bg-transparent":"bg-primary-200"}`})]}),(0,b.jsx)("div",{className:"h-0.5 w-6 bg-primary-200"}),(0,b.jsx)("div",{className:"py-2 sm:py-3",children:(0,b.jsx)(S,{node:i,level:c+1,expanded:d,toggleExpand:e,selectedId:f,onSelect:g,onShowQuickMenu:h,canEdit:m,orientation:n})})]},i.id))})]})]}):(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[w,r&&q&&(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsx)("div",{className:"w-0.5 h-8 bg-gradient-to-b from-primary-300 to-primary-200"}),(0,b.jsx)("div",{className:"flex",children:a.children.map((i,j)=>(0,b.jsxs)("div",{className:"flex flex-col items-center relative",children:[a.children.length>1&&(0,b.jsxs)("div",{className:"flex w-full h-0.5",children:[(0,b.jsx)("div",{className:`flex-1 h-full ${0===j?"bg-transparent":"bg-primary-200"}`}),(0,b.jsx)("div",{className:`flex-1 h-full ${j===a.children.length-1?"bg-transparent":"bg-primary-200"}`})]}),(0,b.jsx)("div",{className:"w-0.5 h-6 bg-primary-200"}),(0,b.jsx)("div",{className:"px-2 sm:px-3",children:(0,b.jsx)(S,{node:i,level:c+1,expanded:d,toggleExpand:e,selectedId:f,onSelect:g,onShowQuickMenu:h,canEdit:m,orientation:n})})]},i.id))})]})]})}function T({members:a,baniId:d,onSelectMember:e}){let[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)(null),k=Array.from({length:Math.max(...a.map(a=>a.generation),0)+1},(a,b)=>b),l=a.filter(a=>{let b=a.fullName.toLowerCase().includes(f.toLowerCase())||a.nickname?.toLowerCase().includes(f.toLowerCase())||a.city?.toLowerCase().includes(f.toLowerCase()),c=null===h||a.generation===h;return b&&c}),m=l.reduce((a,b)=>(a[b.generation]||(a[b.generation]=[]),a[b.generation].push(b),a),{});return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(n.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-surface-400"}),(0,b.jsx)("input",{type:"text",value:f,onChange:a=>g(a.target.value),className:"w-full pl-9 pr-3 py-2.5 rounded-xl border border-surface-200 text-sm text-surface-900 placeholder-surface-400 focus:outline-none focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",placeholder:"Cari nama..."})]}),(0,b.jsxs)("select",{value:null===h?"":h,onChange:a=>i(""===a.target.value?null:parseInt(a.target.value)),className:"px-3 py-2.5 rounded-xl border border-surface-200 text-sm text-surface-700 focus:outline-none focus:border-primary-500 bg-white min-w-[100px]",children:[(0,b.jsx)("option",{value:"",children:"Semua"}),k.map(a=>(0,b.jsxs)("option",{value:a,children:["Gen ",a+1]},a))]})]}),Object.keys(m).sort((a,b)=>Number(a)-Number(b)).map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-xs font-semibold text-surface-400 uppercase tracking-wider mb-2",children:["Generasi ",Number(a)+1]}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:m[Number(a)].map(a=>(0,b.jsxs)("button",{onClick:()=>e(a),className:"group p-3 rounded-xl bg-white border border-surface-200 hover:border-primary-200 hover:shadow-md transition-all flex items-center gap-3 text-left w-full",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${"MALE"===a.gender?"bg-blue-50 text-blue-600":"bg-pink-50 text-pink-600"} ${!a.isAlive?"opacity-60":""}`,children:a.photo?(0,b.jsx)("img",{src:a.photo,alt:a.fullName,className:"w-10 h-10 rounded-full object-cover"}):(0,b.jsx)(j.User,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-surface-900 truncate",children:a.fullName}),!a.isAlive&&(0,b.jsx)("span",{className:"text-[10px] px-1 py-0.5 rounded bg-surface-100 text-surface-400 flex-shrink-0",children:"Alm."})]}),a.nickname&&(0,b.jsx)("p",{className:"text-xs text-surface-400 truncate",children:a.nickname}),a.city&&(0,b.jsxs)("p",{className:"text-[11px] text-surface-400 mt-0.5",children:["ðŸ“ ",a.city]})]}),(0,b.jsx)(u.ChevronRight,{className:"w-4 h-4 text-surface-300 group-hover:text-primary-500 transition-colors flex-shrink-0"})]},a.id))})]},a)),0===l.length&&(0,b.jsxs)("div",{className:"text-center py-12 rounded-xl bg-white border border-surface-200",children:[(0,b.jsx)(j.User,{className:"w-10 h-10 text-surface-300 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-surface-500 text-sm",children:"Tidak ada anggota ditemukan"})]})]})}function U({member:a,baniId:c,onClose:d,onEdit:e}){let f=a=>{if(!a)return null;try{return new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}catch{return a}},g=a.socialMedia,h=g?Object.entries(g).filter(([,a])=>a):[],k=a.phoneWhatsapp||h.length>0,l=a.address||a.city,m=a.birthDate||a.deathDate,n=a.father||a.mother;return(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center p-4 pt-8 sm:items-center sm:pt-4",onClick:d,children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),(0,b.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl animate-scale-in overflow-hidden max-h-[90vh] flex flex-col",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:`relative px-5 pt-5 pb-4 flex-shrink-0 ${"MALE"===a.gender?"bg-gradient-to-br from-blue-50 to-blue-100/50":"bg-gradient-to-br from-pink-50 to-pink-100/50"}`,children:[(0,b.jsx)("button",{onClick:d,className:"absolute top-3 right-3 w-8 h-8 rounded-full bg-white/80 flex items-center justify-center hover:bg-white transition-colors",children:(0,b.jsx)(t.X,{className:"w-4 h-4 text-surface-500"})}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-xl font-bold ${"MALE"===a.gender?"bg-blue-200/60 text-blue-600":"bg-pink-200/60 text-pink-600"} ${!a.isAlive?"opacity-60":""}`,children:a.photo?(0,b.jsx)("img",{src:a.photo,alt:a.fullName,className:"w-16 h-16 rounded-2xl object-cover"}):(0,b.jsx)(j.User,{className:"w-8 h-8"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-surface-900",children:a.fullName}),!a.isAlive&&(0,b.jsx)("span",{className:"px-1.5 py-0.5 rounded-lg bg-surface-200/80 text-surface-500 text-[10px] font-medium",children:"ðŸ•Šï¸ Almarhum/ah"})]}),a.nickname&&(0,b.jsxs)("p",{className:"text-sm text-surface-500",children:['"',a.nickname,'"']}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1.5 mt-1.5",children:[(0,b.jsx)("span",{className:`text-[11px] px-2 py-0.5 rounded-full font-medium ${"MALE"===a.gender?"bg-blue-200/60 text-blue-700":"bg-pink-200/60 text-pink-700"}`,children:"MALE"===a.gender?"ðŸ‘¨ Laki-laki":"ðŸ‘© Perempuan"}),(0,b.jsxs)("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-primary-100/60 text-primary-700 font-medium",children:["Generasi ",a.generation+1]})]})]})]}),a.bio&&(0,b.jsx)("p",{className:"mt-3 text-sm text-surface-600 leading-relaxed",children:a.bio})]}),(0,b.jsxs)("div",{className:"overflow-y-auto flex-1 px-5 py-4 space-y-4",children:[m&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h4",{className:"text-[11px] font-semibold text-surface-400 uppercase tracking-wider flex items-center gap-1.5",children:[(0,b.jsx)(z,{className:"w-3.5 h-3.5"})," Tanggal"]}),a.birthDate&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Tanggal Lahir"}),(0,b.jsxs)("p",{className:"text-sm text-surface-900 font-medium",children:[f(a.birthDate),a.birthPlace?` â€” ${a.birthPlace}`:""]})]}),a.deathDate&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Tanggal Wafat"}),(0,b.jsx)("p",{className:"text-sm text-surface-900 font-medium",children:f(a.deathDate)})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h4",{className:"text-[11px] font-semibold text-surface-400 uppercase tracking-wider flex items-center gap-1.5",children:[(0,b.jsx)(i.Phone,{className:"w-3.5 h-3.5"})," Kontak"]}),k?(0,b.jsxs)(b.Fragment,{children:[a.phoneWhatsapp&&(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("a",{href:(0,K.getWhatsAppLink)(a.phoneWhatsapp),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-green-600 font-medium hover:text-green-500",children:[(0,b.jsx)(i.Phone,{className:"w-3.5 h-3.5"}),a.phoneWhatsapp]})}),h.map(([a,c])=>{let d=M.find(b=>b.key===a);return(0,b.jsxs)("a",{href:N(a,c),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[(0,b.jsx)("div",{className:`w-6 h-6 rounded-md ${d?.bg||"bg-surface-100"} ${d?.color||"text-surface-500"} flex items-center justify-center`,children:(0,b.jsx)(O,{platform:a,className:"w-3 h-3"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:d?.label||a}),(0,b.jsx)("p",{className:"text-sm text-surface-900",children:c})]})]},a)})]}):(0,b.jsx)("p",{className:"text-sm text-surface-400",children:"Belum diisi"})]}),l&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h4",{className:"text-[11px] font-semibold text-surface-400 uppercase tracking-wider flex items-center gap-1.5",children:[(0,b.jsx)(y,{className:"w-3.5 h-3.5"})," Alamat"]}),a.address&&(0,b.jsx)("p",{className:"text-sm text-surface-900",children:a.address}),a.city&&(0,b.jsxs)("p",{className:"text-sm text-surface-600",children:["ðŸ“ ",a.city]})]}),n&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h4",{className:"text-[11px] font-semibold text-surface-400 uppercase tracking-wider flex items-center gap-1.5",children:[(0,b.jsx)(j.User,{className:"w-3.5 h-3.5"})," Orang Tua"]}),a.father&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-7 h-7 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center",children:(0,b.jsx)(j.User,{className:"w-3.5 h-3.5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Ayah"}),(0,b.jsx)("p",{className:"text-sm text-surface-900 font-medium",children:a.father.fullName})]})]}),a.mother&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-7 h-7 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center",children:(0,b.jsx)(j.User,{className:"w-3.5 h-3.5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Ibu"}),(0,b.jsx)("p",{className:"text-sm text-surface-900 font-medium",children:a.mother.fullName})]})]})]})]}),(0,b.jsxs)("div",{className:"px-5 pb-4 pt-2 flex gap-2 flex-shrink-0 border-t border-surface-100",children:[a.phoneWhatsapp&&(0,b.jsxs)("a",{href:(0,K.getWhatsAppLink)(a.phoneWhatsapp),target:"_blank",rel:"noopener noreferrer",className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl bg-green-500 text-white text-sm font-medium hover:bg-green-400 transition-colors",children:[(0,b.jsx)(i.Phone,{className:"w-4 h-4"}),"WhatsApp"]}),(0,b.jsxs)("button",{onClick:()=>{d(),e(a.id)},className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border border-primary-200 text-primary-600 text-sm font-medium hover:bg-primary-50 transition-colors",children:[(0,b.jsx)(A,{className:"w-4 h-4"}),"Edit"]})]})]})]})}function V({baniId:a,existingMembers:d,onClose:e,onSuccess:f}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)("MALE"),[q,r]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(!0),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),O=d.filter(a=>"MALE"===a.gender),Q=d.filter(a=>"FEMALE"===a.gender),R=async b=>{b.preventDefault(),j(""),h(!0);try{let b={};G.forEach(a=>{a.value&&(b[a.key]=a.value)});let c=await fetch("/api/members",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({baniId:a,fullName:k,nickname:m||void 0,gender:o,birthDate:q||void 0,birthPlace:u||void 0,isAlive:w,deathDate:!w&&y?y:void 0,address:A||void 0,city:C||void 0,phoneWhatsapp:E||void 0,socialMedia:Object.keys(b).length>0?b:void 0,bio:I||void 0,fatherId:K||void 0,motherId:M||void 0})}),d=await c.json();if(!c.ok)return void j(d.error||"Gagal menyimpan");f(),e()}catch{j("Terjadi kesalahan. Silakan coba lagi.")}finally{h(!1)}},S="w-full px-3 py-2.5 rounded-xl border border-surface-200 text-sm text-surface-900 placeholder-surface-400 focus:outline-none focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",T="block text-xs font-medium text-surface-600 mb-1";return(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center p-4 pt-8 sm:items-center sm:pt-4",onClick:e,children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),(0,b.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl animate-scale-in overflow-hidden max-h-[90vh] flex flex-col",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-surface-100 flex-shrink-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-surface-900",children:"Tambah Anggota"}),(0,b.jsx)("p",{className:"text-xs text-surface-400",children:"Tambahkan anggota baru ke pohon nasab"})]}),(0,b.jsx)("button",{onClick:e,className:"w-8 h-8 rounded-full bg-surface-100 flex items-center justify-center hover:bg-surface-200 transition-colors",children:(0,b.jsx)(t.X,{className:"w-4 h-4 text-surface-500"})})]}),(0,b.jsxs)("div",{className:"overflow-y-auto flex-1 px-5 py-4",children:[i&&(0,b.jsx)("div",{className:"mb-4 p-3 rounded-xl bg-red-50 border border-red-200 text-red-700 text-xs",children:i}),(0,b.jsxs)("form",{id:"add-member-form",onSubmit:R,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-surface-400 uppercase tracking-wider",children:"Data Dasar"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:T,children:["Nama Lengkap ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:k,onChange:a=>l(a.target.value),className:S,placeholder:"Nama lengkap",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Nama Panggilan"}),(0,b.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),className:S,placeholder:"Panggilan sehari-hari"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:T,children:["Jenis Kelamin ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>p("MALE"),className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${"MALE"===o?"border-blue-500 bg-blue-50 text-blue-700":"border-surface-200 text-surface-500"}`,children:"ðŸ‘¨ Laki-laki"}),(0,b.jsx)("button",{type:"button",onClick:()=>p("FEMALE"),className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${"FEMALE"===o?"border-pink-500 bg-pink-50 text-pink-700":"border-surface-200 text-surface-500"}`,children:"ðŸ‘© Perempuan"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Tanggal Lahir"}),(0,b.jsx)("input",{type:"date",value:q,onChange:a=>r(a.target.value),className:S})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Tempat Lahir"}),(0,b.jsx)("input",{type:"text",value:u,onChange:a=>v(a.target.value),className:S,placeholder:"Kota"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Status"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{x(!0),z("")},className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${w?"border-green-500 bg-green-50 text-green-700":"border-surface-200 text-surface-500"}`,children:"â¤ï¸ Masih Hidup"}),(0,b.jsx)("button",{type:"button",onClick:()=>x(!1),className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${!w?"border-surface-500 bg-surface-100 text-surface-700":"border-surface-200 text-surface-500"}`,children:"ðŸ•Šï¸ Sudah Wafat"})]})]}),!w&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Tanggal Wafat"}),(0,b.jsx)("input",{type:"date",value:y,onChange:a=>z(a.target.value),className:S})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-2 border-t border-surface-100",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-surface-400 uppercase tracking-wider",children:"Relasi Keluarga"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Ayah"}),(0,b.jsxs)("select",{value:K,onChange:a=>L(a.target.value),className:S,children:[(0,b.jsx)("option",{value:"",children:"-- Pilih Ayah --"}),O.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.fullName," (Gen. ",a.generation+1,")"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Ibu"}),(0,b.jsxs)("select",{value:M,onChange:a=>N(a.target.value),className:S,children:[(0,b.jsx)("option",{value:"",children:"-- Pilih Ibu --"}),Q.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.fullName," (Gen. ",a.generation+1,")"]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-2 border-t border-surface-100",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-surface-400 uppercase tracking-wider",children:"Kontak & Alamat"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"No. WhatsApp"}),(0,b.jsx)("input",{type:"tel",value:E,onChange:a=>F(a.target.value),className:S,placeholder:"08xxxxxxxxxx"})]}),(0,b.jsx)(P,{entries:G,onChange:H,inputClass:S,labelClass:T}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Alamat"}),(0,b.jsx)("input",{type:"text",value:A,onChange:a=>B(a.target.value),className:S,placeholder:"Alamat"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Kota"}),(0,b.jsx)("input",{type:"text",value:C,onChange:a=>D(a.target.value),className:S,placeholder:"Kota"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:T,children:"Bio / Catatan"}),(0,b.jsx)("textarea",{value:I,onChange:a=>J(a.target.value),rows:2,className:`${S} resize-none`,placeholder:"Catatan tentang anggota ini"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 px-5 py-4 border-t border-surface-100 flex-shrink-0",children:[(0,b.jsx)("button",{type:"button",onClick:e,className:"flex-1 py-2.5 rounded-xl border border-surface-200 text-surface-600 font-medium text-sm hover:bg-surface-50 transition-colors",children:"Batal"}),(0,b.jsx)("button",{type:"submit",form:"add-member-form",disabled:g,className:"flex-1 py-2.5 rounded-xl bg-gradient-to-r from-primary-600 to-primary-700 text-white font-semibold text-sm hover:from-primary-500 hover:to-primary-600 transition-all shadow-lg shadow-primary-600/20 disabled:opacity-50 flex items-center justify-center gap-2",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Loader2,{className:"w-4 h-4 animate-spin"}),"Menyimpan..."]}):"Simpan"})]})]})]})}function W({memberId:a,baniId:d,allMembers:e,onClose:f,onSuccess:g}){let[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,u]=(0,c.useState)(""),[v,w]=(0,c.useState)("MALE"),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)([]),[O,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{let b=await fetch(`/api/members/${a}`,{credentials:"include"});if(!b.ok){let a=await b.json().catch(()=>({}));o(a.error||`Error ${b.status}`),i(!1);return}let c=await b.json();q(c.fullName),u(c.nickname||""),w(c.gender),y(c.birthDate?c.birthDate.split("T")[0]:""),A(c.birthPlace||""),D(c.isAlive),F(c.deathDate?c.deathDate.split("T")[0]:""),H(c.address||""),J(c.city||""),L(c.phoneWhatsapp||"");let d=c.socialMedia;d&&N(Object.entries(d).filter(([,a])=>a).map(([a,b])=>({key:a,value:b}))),Q(c.bio||""),S(c.fatherId||""),U(c.motherId||"")}catch(a){console.error("Failed to fetch:",a),o("Gagal memuat data")}finally{i(!1)}})()},[a]);let V=async b=>{b.preventDefault(),o(""),k(!0);try{let b={};M.forEach(a=>{a.value&&(b[a.key]=a.value)});let c=await fetch(`/api/members/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:p,nickname:r||void 0,gender:v,birthDate:x||void 0,birthPlace:z||void 0,isAlive:C,deathDate:!C&&E?E:void 0,address:G||void 0,city:I||void 0,phoneWhatsapp:K||void 0,socialMedia:Object.keys(b).length>0?b:void 0,bio:O||void 0,fatherId:R||void 0,motherId:T||void 0})}),d=await c.json();if(!c.ok)return void o(d.error);g()}catch{o("Terjadi kesalahan. Silakan coba lagi.")}finally{k(!1)}},W=async()=>{if(confirm("Apakah Anda yakin ingin menghapus anggota ini? Tindakan ini tidak dapat dibatalkan.")){m(!0);try{let b=await fetch(`/api/members/${a}`,{method:"DELETE"});if(!b.ok){let a=await b.json();o(a.error);return}g()}catch{o("Gagal menghapus anggota")}finally{m(!1)}}},X=e.filter(b=>"MALE"===b.gender&&b.id!==a),Y=e.filter(b=>"FEMALE"===b.gender&&b.id!==a),Z="w-full px-3 py-2.5 rounded-xl border border-surface-200 text-sm text-surface-900 placeholder-surface-400 focus:outline-none focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",$="block text-xs font-medium text-surface-600 mb-1";return(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center p-4 pt-8 sm:items-center sm:pt-4",onClick:f,children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),(0,b.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl animate-scale-in overflow-hidden max-h-[90vh] flex flex-col",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-surface-100 flex-shrink-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-surface-900",children:"Edit Anggota"}),p&&(0,b.jsxs)("p",{className:"text-xs text-surface-400",children:["Ubah data ",p]})]}),(0,b.jsx)("button",{onClick:f,className:"w-8 h-8 rounded-full bg-surface-100 flex items-center justify-center hover:bg-surface-200 transition-colors",children:(0,b.jsx)(t.X,{className:"w-4 h-4 text-surface-500"})})]}),h?(0,b.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,b.jsx)(s.Loader2,{className:"w-8 h-8 animate-spin text-primary-500"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"overflow-y-auto flex-1 px-5 py-4",children:[n&&(0,b.jsx)("div",{className:"mb-4 p-3 rounded-xl bg-red-50 border border-red-200 text-red-700 text-xs",children:n}),(0,b.jsxs)("form",{id:"edit-member-form",onSubmit:V,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-surface-400 uppercase tracking-wider",children:"Data Dasar"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:$,children:["Nama Lengkap ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:p,onChange:a=>q(a.target.value),className:Z,required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Nama Panggilan"}),(0,b.jsx)("input",{type:"text",value:r,onChange:a=>u(a.target.value),className:Z})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Jenis Kelamin"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>w("MALE"),className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${"MALE"===v?"border-blue-500 bg-blue-50 text-blue-700":"border-surface-200 text-surface-500"}`,children:"ðŸ‘¨ Laki-laki"}),(0,b.jsx)("button",{type:"button",onClick:()=>w("FEMALE"),className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${"FEMALE"===v?"border-pink-500 bg-pink-50 text-pink-700":"border-surface-200 text-surface-500"}`,children:"ðŸ‘© Perempuan"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Tanggal Lahir"}),(0,b.jsx)("input",{type:"date",value:x,onChange:a=>y(a.target.value),className:Z})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Tempat Lahir"}),(0,b.jsx)("input",{type:"text",value:z,onChange:a=>A(a.target.value),className:Z})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Status"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{D(!0),F("")},className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${C?"border-green-500 bg-green-50 text-green-700":"border-surface-200 text-surface-500"}`,children:"â¤ï¸ Masih Hidup"}),(0,b.jsx)("button",{type:"button",onClick:()=>D(!1),className:`flex-1 py-2.5 rounded-xl border text-xs font-medium transition-all ${!C?"border-surface-500 bg-surface-100 text-surface-700":"border-surface-200 text-surface-500"}`,children:"ðŸ•Šï¸ Sudah Wafat"})]})]}),!C&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Tanggal Wafat"}),(0,b.jsx)("input",{type:"date",value:E,onChange:a=>F(a.target.value),className:Z})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-2 border-t border-surface-100",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-surface-400 uppercase tracking-wider",children:"Relasi Keluarga"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Ayah"}),(0,b.jsxs)("select",{value:R,onChange:a=>S(a.target.value),className:Z,children:[(0,b.jsx)("option",{value:"",children:"-- Pilih Ayah --"}),X.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.fullName," (Gen. ",a.generation+1,")"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Ibu"}),(0,b.jsxs)("select",{value:T,onChange:a=>U(a.target.value),className:Z,children:[(0,b.jsx)("option",{value:"",children:"-- Pilih Ibu --"}),Y.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.fullName," (Gen. ",a.generation+1,")"]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-2 border-t border-surface-100",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-surface-400 uppercase tracking-wider",children:"Kontak & Alamat"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"No. WhatsApp"}),(0,b.jsx)("input",{type:"tel",value:K,onChange:a=>L(a.target.value),className:Z,placeholder:"08xxxxxxxxxx"})]}),(0,b.jsx)(P,{entries:M,onChange:N,inputClass:Z,labelClass:$}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Alamat"}),(0,b.jsx)("input",{type:"text",value:G,onChange:a=>H(a.target.value),className:Z})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Kota"}),(0,b.jsx)("input",{type:"text",value:I,onChange:a=>J(a.target.value),className:Z})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:$,children:"Bio / Catatan"}),(0,b.jsx)("textarea",{value:O,onChange:a=>Q(a.target.value),rows:2,className:`${Z} resize-none`})]})]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 px-5 py-4 border-t border-surface-100 flex-shrink-0",children:[(0,b.jsx)("button",{type:"button",onClick:W,disabled:l,className:"px-3 py-2.5 rounded-xl border border-red-200 text-red-600 hover:bg-red-50 transition-colors disabled:opacity-50 flex items-center gap-1",children:l?(0,b.jsx)(s.Loader2,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(B.Trash2,{className:"w-4 h-4"})}),(0,b.jsx)("button",{type:"button",onClick:f,className:"flex-1 py-2.5 rounded-xl border border-surface-200 text-surface-600 font-medium text-sm hover:bg-surface-50 transition-colors",children:"Batal"}),(0,b.jsx)("button",{type:"submit",form:"edit-member-form",disabled:j,className:"flex-1 py-2.5 rounded-xl bg-gradient-to-r from-primary-600 to-primary-700 text-white font-semibold text-sm hover:from-primary-500 hover:to-primary-600 transition-all shadow-lg shadow-primary-600/20 disabled:opacity-50 flex items-center justify-center gap-2",children:j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Loader2,{className:"w-4 h-4 animate-spin"}),"Menyimpan..."]}):"Simpan"})]})]})]})]})}function X({baniId:a,baniName:g,members:k,canEdit:l,initialOrientation:m="VERTICAL",initialIsPublic:n=!1,initialShowWa:p=!1,initialShowBirth:q=!1,initialShowAddress:r=!1,initialShowSocmed:s=!1}){let u,v,z,[B,P]=(0,c.useState)("tree"),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)(!0),[_,aa]=(0,c.useState)(new Set),[ab,ac]=(0,c.useState)(null),[ad,ae]=(0,c.useState)(1),af=(0,c.useRef)(null),ag=(0,c.useRef)(null),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(null),[al,am]=(0,c.useState)(null),[an,ao]=(0,c.useState)(null),[ap,aq]=(0,c.useState)(!1),[ar,as]=(0,c.useState)(null),[at,au]=(0,c.useState)(!1),[av,aw]=(0,c.useState)(m),[ax,ay]=(0,c.useState)(n),[az,aA]=(0,c.useState)(!1),[aB,aC]=(0,c.useState)(!1),[aD,aE]=(0,c.useState)(p),[aF,aG]=(0,c.useState)(q),[aH,aI]=(0,c.useState)(r),[aJ,aK]=(0,c.useState)(s),aL=(0,c.useCallback)(async()=>{try{let b=await fetch(`/api/members?baniId=${a}`),c=await b.json();Y(c);let d=new Set;c.forEach(a=>{a.generation<=1&&d.add(a.id)}),aa(d)}catch(a){console.error("Failed to fetch:",a)}finally{$(!1)}},[a]);(0,c.useEffect)(()=>{aL()},[aL]);let aM=function(a,b){let c;if(0===a.length)return null;let d=new Map;return a.forEach(a=>d.set(a.id,a)),c||(c=a.find(a=>0===a.generation)),c||(c=a.reduce((a,b)=>a.generation<b.generation?a:b)),function b(c){let d=a.filter(a=>a.fatherId===c.id||a.motherId===c.id).filter((a,b,c)=>c.findIndex(b=>b.id===a.id)===b).sort((a,b)=>a.fullName.localeCompare(b.fullName));return{...c,children:d.map(a=>b(a))}}(c)}(X),aN=(0,c.useCallback)(a=>{aa(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},[]),aO=ab?X.find(a=>a.id===ab):null,aP=()=>ae(a=>Math.min(a+.1,2)),aQ=()=>ae(a=>Math.max(a-.1,.3)),aR=()=>ae(1),aS=(0,c.useCallback)(()=>{af.current&&(document.fullscreenElement?document.exitFullscreen():af.current.requestFullscreen().catch(a=>{console.error("Fullscreen error:",a)}))},[]);(0,c.useEffect)(()=>{let a=()=>{ai(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",a),()=>document.removeEventListener("fullscreenchange",a)},[]);let aT=(0,c.useRef)(ad);aT.current=ad;let aU=(0,c.useRef)(new Map),aV=(0,c.useRef)(0),aW=(0,c.useRef)(1),aX=(0,c.useCallback)(a=>{if(aU.current.set(a.pointerId,{x:a.clientX,y:a.clientY}),a.target.setPointerCapture?.(a.pointerId),2===aU.current.size){let a=Array.from(aU.current.values()),b=a[0].x-a[1].x,c=a[0].y-a[1].y;aV.current=Math.sqrt(b*b+c*c),aW.current=aT.current}},[]),aY=(0,c.useCallback)(a=>{if(aU.current.has(a.pointerId)&&(aU.current.set(a.pointerId,{x:a.clientX,y:a.clientY}),2===aU.current.size&&aV.current>0)){a.preventDefault();let b=Array.from(aU.current.values()),c=b[0].x-b[1].x,d=b[0].y-b[1].y,e=Math.sqrt(c*c+d*d)/aV.current;ae(Math.round(100*Math.min(Math.max(aW.current*e,.2),3))/100)}},[]),aZ=(0,c.useCallback)(a=>{aU.current.delete(a.pointerId),aU.current.size<2&&(aV.current=0)},[]),a$=(0,c.useCallback)((a,b)=>{ak({type:b,member:a})},[]),a_=(0,c.useCallback)(a=>{am(a)},[]),a0=(0,c.useCallback)(a=>{al&&(a$(al,a),am(null))},[al,a$]),a1=(0,c.useCallback)(()=>{ak(null),aL()},[aL]),a2=(0,c.useCallback)(()=>{aL(),window.location.reload()},[aL]),a3=(0,c.useCallback)(async(b,c,d)=>{aA(!0);try{await fetch(`/api/banis/${a}/settings`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({treeOrientation:b,isPublic:c,...d})}),aw(b),ay(c),d?.showWaPublic!==void 0&&aE(d.showWaPublic),d?.showBirthPublic!==void 0&&aG(d.showBirthPublic),d?.showAddressPublic!==void 0&&aI(d.showAddressPublic),d?.showSocmedPublic!==void 0&&aK(d.showSocmedPublic)}catch(a){console.error("Save settings error:",a)}finally{aA(!1)}},[a]),a4=(0,c.useCallback)(async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText("");else{let a=document.createElement("textarea");a.value="",a.style.position="fixed",a.style.left="-9999px",a.style.top="-9999px",document.body.appendChild(a),a.focus(),a.select(),document.execCommand("copy"),document.body.removeChild(a)}aC(!0),setTimeout(()=>aC(!1),2e3)}catch{window.prompt("Salin link ini:","")}},[""]);return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex rounded-xl bg-surface-100 p-1 flex-1",children:[(0,b.jsxs)("button",{onClick:()=>P("tree"),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${"tree"===B?"bg-white text-primary-700 shadow-sm":"text-surface-500 hover:text-surface-700"}`,children:[(0,b.jsx)(w.TreePine,{className:"w-4 h-4"}),"Pohon Nasab"]}),(0,b.jsxs)("button",{onClick:()=>P("list"),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${"list"===B?"bg-white text-primary-700 shadow-sm":"text-surface-500 hover:text-surface-700"}`,children:[(0,b.jsx)(x.List,{className:"w-4 h-4"}),"Daftar (",k.length,")"]})]}),l&&(0,b.jsx)("button",{onClick:()=>au(!0),className:"p-2.5 rounded-xl bg-white border border-surface-200 shadow-sm hover:bg-surface-50 active:bg-surface-100 transition-colors",title:"Pengaturan",children:(0,b.jsx)(C.Settings,{className:"w-4 h-4 text-surface-500"})}),"tree"===B&&(0,b.jsxs)("div",{className:"hidden sm:flex items-center gap-3 ml-auto",children:[(0,b.jsxs)("div",{className:"flex items-center bg-white rounded-xl border border-surface-200 shadow-sm overflow-hidden",children:[(0,b.jsx)("button",{onClick:aQ,className:"p-2.5 hover:bg-surface-50 active:bg-surface-100 transition-colors",title:"Perkecil",children:(0,b.jsx)(e.ZoomOut,{className:"w-4 h-4 text-surface-500"})}),(0,b.jsx)("div",{className:"w-px h-5 bg-surface-200"}),(0,b.jsx)("button",{onClick:aR,className:"px-3 py-2 hover:bg-surface-50 active:bg-surface-100 transition-colors",title:"Reset zoom",children:(0,b.jsxs)("span",{className:"text-xs font-semibold text-primary-600 min-w-[2.5rem] text-center block",children:[Math.round(100*ad),"%"]})}),(0,b.jsx)("div",{className:"w-px h-5 bg-surface-200"}),(0,b.jsx)("button",{onClick:aP,className:"p-2.5 hover:bg-surface-50 active:bg-surface-100 transition-colors",title:"Perbesar",children:(0,b.jsx)(d.ZoomIn,{className:"w-4 h-4 text-surface-500"})}),(0,b.jsx)("div",{className:"w-px h-5 bg-surface-200"}),(0,b.jsx)("button",{onClick:aS,className:"p-2.5 hover:bg-surface-50 active:bg-surface-100 transition-colors",title:ah?"Keluar layar penuh":"Layar penuh",children:ah?(0,b.jsx)(h,{className:"w-4 h-4 text-surface-500"}):(0,b.jsx)(f.Maximize2,{className:"w-4 h-4 text-surface-500"})})]}),(0,b.jsx)(L.default,{treeContainerRef:ag,baniName:g||"Pohon-Nasab"})]}),l&&"list"===B&&(0,b.jsxs)("button",{onClick:()=>aq(!0),className:"hidden sm:inline-flex ml-auto touch-target items-center gap-2 px-4 py-2 rounded-xl bg-primary-600 text-white font-medium text-sm hover:bg-primary-500 transition-colors shadow-md shadow-primary-600/20",children:[(0,b.jsx)(o.Plus,{className:"w-4 h-4"}),"Tambah"]})]}),l&&"list"===B&&(0,b.jsxs)("button",{onClick:()=>aq(!0),className:"sm:hidden inline-flex items-center justify-center gap-2 px-3 py-2 rounded-xl bg-primary-600 text-white font-medium text-xs hover:bg-primary-500 transition-colors shadow-md shadow-primary-600/20",children:[(0,b.jsx)(o.Plus,{className:"w-3.5 h-3.5"}),"Tambah Anggota"]})]}),"tree"===B?(0,b.jsx)(b.Fragment,{children:Z?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[40vh] sm:min-h-[60vh]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-surface-500 text-sm",children:"Memuat pohon nasab..."})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"sm:hidden",children:(0,b.jsx)(L.default,{treeContainerRef:ag,baniName:g||"Pohon-Nasab"})}),(0,b.jsxs)("div",{ref:af,className:"relative overflow-auto rounded-xl sm:rounded-2xl bg-white border border-surface-200 min-h-[40vh] sm:min-h-[60vh] p-3 sm:p-8",style:{touchAction:"pan-x pan-y"},onPointerDown:aX,onPointerMove:aY,onPointerUp:aZ,onPointerCancel:aZ,children:[(0,b.jsxs)("div",{className:"sm:hidden fixed bottom-20 right-3 z-30 flex flex-col gap-2",children:[(0,b.jsx)("button",{onClick:aP,className:"w-10 h-10 rounded-full bg-white border border-surface-200 shadow-lg flex items-center justify-center active:bg-surface-100 transition-colors",title:"Perbesar",children:(0,b.jsx)(d.ZoomIn,{className:"w-4 h-4 text-surface-600"})}),(0,b.jsx)("button",{onClick:aR,className:"w-10 h-10 rounded-full bg-white border border-surface-200 shadow-lg flex items-center justify-center active:bg-surface-100 transition-colors",title:"Reset zoom",children:(0,b.jsxs)("span",{className:"text-[10px] font-bold text-primary-600",children:[Math.round(100*ad),"%"]})}),(0,b.jsx)("button",{onClick:aQ,className:"w-10 h-10 rounded-full bg-white border border-surface-200 shadow-lg flex items-center justify-center active:bg-surface-100 transition-colors",title:"Perkecil",children:(0,b.jsx)(e.ZoomOut,{className:"w-4 h-4 text-surface-600"})}),(0,b.jsx)("button",{onClick:aS,className:"w-10 h-10 rounded-full bg-primary-600 shadow-lg shadow-primary-600/30 flex items-center justify-center active:bg-primary-500 transition-colors",title:ah?"Keluar layar penuh":"Layar penuh",children:ah?(0,b.jsx)(h,{className:"w-4 h-4 text-white"}):(0,b.jsx)(f.Maximize2,{className:"w-4 h-4 text-white"})})]}),(0,b.jsx)("div",{ref:ag,className:"min-w-fit",children:(0,b.jsx)("div",{style:{transform:`scale(${ad})`,transformOrigin:"top left"},className:"flex justify-center min-w-fit",children:aM?(0,b.jsx)(S,{node:aM,level:0,expanded:_,toggleExpand:aN,selectedId:ab,onSelect:ac,onShowQuickMenu:a_,canEdit:l,orientation:av}):(0,b.jsx)("div",{className:"text-center py-20",children:(0,b.jsx)("p",{className:"text-surface-500",children:"Belum ada anggota di pohon ini"})})})})]}),aO&&(u=a=>{if(!a)return null;try{return new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}catch{return a}},v=[],(aO.birthPlace||aO.birthDate)&&v.push([aO.birthPlace,u(aO.birthDate)].filter(Boolean).join(", ")),aO.city&&v.push(aO.city),aO.deathDate&&v.push("Wafat "+u(aO.deathDate)),(0,b.jsxs)("div",{className:"flex items-center gap-3 px-3 py-2.5 rounded-xl border border-surface-200 bg-white shadow-sm animate-scale-in",children:[(0,b.jsx)("div",{className:`w-9 h-9 rounded-full flex items-center justify-center flex-shrink-0 ${"MALE"===aO.gender?"bg-blue-100 text-blue-600":"bg-pink-100 text-pink-600"}`,children:aO.photo?(0,b.jsx)("img",{src:aO.photo,alt:aO.fullName,className:"w-9 h-9 rounded-full object-cover"}):(0,b.jsx)(j.User,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 flex-wrap",children:[(0,b.jsx)("span",{className:"font-semibold text-sm text-surface-900 truncate",children:aO.fullName}),aO.nickname&&(0,b.jsxs)("span",{className:"text-xs text-surface-400 truncate",children:["â€œ",aO.nickname,"â€"]}),!aO.isAlive&&(0,b.jsxs)("span",{className:"text-[10px] bg-surface-100 text-surface-400 px-1 py-0.5 rounded",children:["Alm","FEMALE"===aO.gender?"h":"","."]}),(0,b.jsxs)("span",{className:"text-[10px] text-surface-400 bg-surface-50 px-1.5 py-0.5 rounded",children:["Gen ",aO.generation]})]}),v.length>0&&(0,b.jsx)("p",{className:"text-[11px] text-surface-400 truncate mt-0.5",children:v.join(" Â· ")})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[aO.phoneWhatsapp&&(0,b.jsx)("a",{href:(0,K.getWhatsAppLink)(aO.phoneWhatsapp),target:"_blank",rel:"noopener noreferrer",className:"w-7 h-7 rounded-lg bg-green-500 text-white flex items-center justify-center hover:bg-green-400 transition-colors",title:"WhatsApp",children:(0,b.jsx)(i.Phone,{className:"w-3 h-3"})}),(z=aO.socialMedia)?Object.entries(z).filter(([,a])=>a).map(([a])=>{let c=M.find(b=>b.key===a);return c?(0,b.jsx)("a",{href:N(a,z[a]),target:"_blank",rel:"noopener noreferrer",className:`w-7 h-7 rounded-lg ${c.bg} ${c.color} flex items-center justify-center hover:opacity-80 transition-opacity`,title:`${c.label}: ${z[a]}`,children:(0,b.jsx)(O,{platform:a,className:"w-3 h-3"})},a):null}):null,l&&(0,b.jsx)("button",{onClick:()=>as(aO.id),className:"w-7 h-7 rounded-lg border border-surface-200 text-surface-500 flex items-center justify-center hover:bg-surface-50 transition-colors",title:"Edit",children:(0,b.jsx)(A,{className:"w-3 h-3"})}),(0,b.jsx)("button",{onClick:()=>ac(null),className:"w-7 h-7 rounded-lg border border-surface-200 text-surface-400 flex items-center justify-center hover:bg-surface-50 transition-colors",title:"Tutup",children:(0,b.jsx)(t.X,{className:"w-3 h-3"})})]})]}))]})}):(0,b.jsx)(T,{members:k,baniId:a,onSelectMember:ao}),al&&(0,b.jsx)(Q,{node:al,onSelect:a0,onClose:()=>am(null)}),aj&&(0,b.jsx)(R,{context:aj,allMembers:X,baniId:a,onClose:()=>ak(null),onSuccess:a1}),an&&(0,b.jsx)(U,{member:an,baniId:a,onClose:()=>ao(null),onEdit:a=>as(a)}),ar&&(0,b.jsx)(W,{memberId:ar,baniId:a,allMembers:k,onClose:()=>as(null),onSuccess:()=>{as(null),aL(),window.location.reload()}}),ap&&(0,b.jsx)(V,{baniId:a,existingMembers:k,onClose:()=>aq(!1),onSuccess:a2}),at&&(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>au(!1)}),(0,b.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-sm animate-scale-in",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-surface-100 flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-lg font-bold text-surface-900 flex items-center gap-2",children:[(0,b.jsx)(C.Settings,{className:"w-5 h-5 text-primary-600"})," Pengaturan Tree"]}),(0,b.jsx)("button",{onClick:()=>au(!1),className:"p-1.5 rounded-lg hover:bg-surface-100 transition-colors",children:(0,b.jsx)(t.X,{className:"w-5 h-5 text-surface-400"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"text-xs font-semibold text-surface-500 uppercase tracking-wider mb-3 block flex items-center gap-1.5",children:[(0,b.jsx)(H,{className:"w-3.5 h-3.5"})," Orientasi Pohon"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)("button",{onClick:()=>a3("VERTICAL",ax),disabled:az,className:`p-4 rounded-xl border-2 transition-all text-center ${"VERTICAL"===av?"border-primary-500 bg-primary-50":"border-surface-200 hover:border-surface-300"}`,children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsxs)("svg",{className:"w-8 h-8",viewBox:"0 0 32 32",fill:"none",children:[(0,b.jsx)("circle",{cx:"16",cy:"4",r:"3",className:"VERTICAL"===av?"fill-primary-500":"fill-surface-300"}),(0,b.jsx)("line",{x1:"16",y1:"7",x2:"16",y2:"16",className:"VERTICAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("line",{x1:"8",y1:"16",x2:"24",y2:"16",className:"VERTICAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("line",{x1:"8",y1:"16",x2:"8",y2:"22",className:"VERTICAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("line",{x1:"24",y1:"16",x2:"24",y2:"22",className:"VERTICAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("circle",{cx:"8",cy:"25",r:"3",className:"VERTICAL"===av?"fill-primary-400":"fill-surface-300"}),(0,b.jsx)("circle",{cx:"24",cy:"25",r:"3",className:"VERTICAL"===av?"fill-primary-400":"fill-surface-300"})]}),(0,b.jsx)("span",{className:`text-xs font-medium ${"VERTICAL"===av?"text-primary-700":"text-surface-500"}`,children:"Vertikal"})]})}),(0,b.jsx)("button",{onClick:()=>a3("HORIZONTAL",ax),disabled:az,className:`p-4 rounded-xl border-2 transition-all text-center ${"HORIZONTAL"===av?"border-primary-500 bg-primary-50":"border-surface-200 hover:border-surface-300"}`,children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsxs)("svg",{className:"w-8 h-8",viewBox:"0 0 32 32",fill:"none",children:[(0,b.jsx)("circle",{cx:"4",cy:"16",r:"3",className:"HORIZONTAL"===av?"fill-primary-500":"fill-surface-300"}),(0,b.jsx)("line",{x1:"7",y1:"16",x2:"16",y2:"16",className:"HORIZONTAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("line",{x1:"16",y1:"8",x2:"16",y2:"24",className:"HORIZONTAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("line",{x1:"16",y1:"8",x2:"22",y2:"8",className:"HORIZONTAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("line",{x1:"16",y1:"24",x2:"22",y2:"24",className:"HORIZONTAL"===av?"stroke-primary-400":"stroke-surface-300",strokeWidth:"2"}),(0,b.jsx)("circle",{cx:"25",cy:"8",r:"3",className:"HORIZONTAL"===av?"fill-primary-400":"fill-surface-300"}),(0,b.jsx)("circle",{cx:"25",cy:"24",r:"3",className:"HORIZONTAL"===av?"fill-primary-400":"fill-surface-300"})]}),(0,b.jsx)("span",{className:`text-xs font-medium ${"HORIZONTAL"===av?"text-primary-700":"text-surface-500"}`,children:"Horizontal"})]})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"text-xs font-semibold text-surface-500 uppercase tracking-wider mb-3 block flex items-center gap-1.5",children:[ax?(0,b.jsx)(D,{className:"w-3.5 h-3.5"}):(0,b.jsx)(E.Lock,{className:"w-3.5 h-3.5"})," Visibilitas"]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("button",{onClick:()=>a3(av,!1),disabled:az,className:`w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left ${!ax?"border-primary-500 bg-primary-50":"border-surface-200 hover:border-surface-300"}`,children:[(0,b.jsx)(E.Lock,{className:`w-5 h-5 ${!ax?"text-primary-600":"text-surface-300"}`}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm font-medium ${!ax?"text-primary-700":"text-surface-600"}`,children:"Privat"}),(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Hanya anggota yang bisa melihat"})]})]}),(0,b.jsxs)("button",{onClick:()=>a3(av,!0),disabled:az,className:`w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left ${ax?"border-green-500 bg-green-50":"border-surface-200 hover:border-surface-300"}`,children:[(0,b.jsx)(D,{className:`w-5 h-5 ${ax?"text-green-600":"text-surface-300"}`}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:`text-sm font-medium ${ax?"text-green-700":"text-surface-600"}`,children:"Publik"}),(0,b.jsx)("p",{className:"text-[11px] text-surface-400",children:"Siapapun dengan link bisa melihat pohon"})]})]})]}),ax&&(0,b.jsxs)("div",{className:"mt-3 p-3 rounded-lg bg-green-50 border border-green-200",children:[(0,b.jsx)("p",{className:"text-[11px] text-green-700 font-medium mb-2",children:"Link Publik:"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"text",readOnly:!0,value:"",className:"flex-1 px-2.5 py-1.5 rounded-lg bg-white border border-green-200 text-xs text-surface-700 truncate"}),(0,b.jsxs)("button",{onClick:a4,className:"flex items-center gap-1 px-3 py-1.5 rounded-lg bg-green-600 text-white text-xs font-medium hover:bg-green-500 transition-colors flex-shrink-0",children:[aB?(0,b.jsx)(G,{className:"w-3.5 h-3.5"}):(0,b.jsx)(F,{className:"w-3.5 h-3.5"}),aB?"Tersalin!":"Salin"]})]})]}),ax&&(0,b.jsxs)("div",{className:"mt-4 pt-4 border-t border-surface-200",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-surface-500 uppercase tracking-wider mb-3 block",children:"Data Ditampilkan di Publik"}),(0,b.jsx)("div",{className:"space-y-2",children:[{key:"showWaPublic",label:"Nomor WhatsApp",value:aD,iconComponent:(0,b.jsx)(I.Smartphone,{className:"w-4 h-4 text-green-500"}),iconBg:"bg-green-50"},{key:"showBirthPublic",label:"Tanggal Lahir",value:aF,iconComponent:(0,b.jsx)(J,{className:"w-4 h-4 text-blue-500"}),iconBg:"bg-blue-50"},{key:"showAddressPublic",label:"Alamat",value:aH,iconComponent:(0,b.jsx)(y,{className:"w-4 h-4 text-red-500"}),iconBg:"bg-red-50"},{key:"showSocmedPublic",label:"Sosial Media",value:aJ,iconComponent:(0,b.jsx)(D,{className:"w-4 h-4 text-purple-500"}),iconBg:"bg-purple-50"}].map(a=>(0,b.jsxs)("button",{onClick:()=>a3(av,!0,{[a.key]:!a.value}),disabled:az,className:"w-full flex items-center justify-between p-2.5 rounded-lg border border-surface-200 hover:bg-surface-50 transition-all",children:[(0,b.jsxs)("span",{className:"flex items-center gap-2.5 text-sm text-surface-700",children:[(0,b.jsx)("span",{className:`w-7 h-7 rounded-lg ${a.iconBg} flex items-center justify-center flex-shrink-0`,children:a.iconComponent}),(0,b.jsx)("span",{className:"font-medium",children:a.label})]}),(0,b.jsx)("div",{className:`w-9 h-5 rounded-full transition-colors relative ${a.value?"bg-green-500":"bg-surface-300"}`,children:(0,b.jsx)("div",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow transition-transform ${a.value?"translate-x-4":"translate-x-0.5"}`})})]},a.key))})]})]}),az&&(0,b.jsx)("p",{className:"text-xs text-primary-500 text-center animate-pulse",children:"Menyimpan..."})]})]})]})]})}a.s(["default",()=>X],31052)}];

//# sourceMappingURL=src_app_dashboard_bani_%5Bid%5D_BaniContent_tsx_b3ca2c64._.js.map